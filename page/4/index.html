<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    findmoon-白色蜗牛
  
</title>

<meta name="description" content="人生是一场不断的转换，我们总是不断地试着所向披靡">
<meta property="og:type" content="website">
<meta property="og:title" content="findmoon-白色蜗牛">
<meta property="og:url" content="//findmoon.github.io/index.html/page/4/index.html">
<meta property="og:site_name" content="findmoon-白色蜗牛">
<meta property="og:description" content="人生是一场不断的转换，我们总是不断地试着所向披靡">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="findmoon-白色蜗牛">
<meta name="twitter:description" content="人生是一场不断的转换，我们总是不断地试着所向披靡">




  <link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="/perfect-scrollbar/css/perfect-scrollbar.min.css">
<link rel="stylesheet" href="/styles/main.css">






</head>
<body
  
    class="monochrome"
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/">findmoon-白色蜗牛</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/">findmoon-白色蜗牛</a></h1>
    
      <p class="subtitle">
        一个试图专注于自身的成长者
      </p>
    
    <div class="info">
      <div class="content">
        
          <div class="description">人生是一场不断的转换，我们总是不断地试着所向披靡</div>
        
        
          <div class="author">findmoon</div>
        
      </div>
      
        <div class="avatar">
          
            <a href="/about"><img src="http://i2.piimg.com/81760750547ee122.jpg"></a>
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li class="category-list-container">
                <a href="javascript:;">分类</a>
                <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/html/">html</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">134</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/方法-实例/">方法/实例</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随笔/">随笔</a><span class="category-list-count">10</span></li></ul>
              </li>
            
          
            
              <li class="tag-list-container">
                <a href="javascript:;">标签</a>
                <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Array/">Array</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BFC/">BFC</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backbone/">Backbone</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS3动画/">CSS3动画</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DNS解析域名/">DNS解析域名</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOCTYPE/">DOCTYPE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/">Javascript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MV模式/">MV模式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mocha/">Mocha</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-UDP/">TCP/UDP</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP三次握手/">TCP三次握手</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TDD/">TDD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UNICODE-ASCII/">UNICODE/ASCII</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animate/">animate()</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animate动画队列/">animate动画队列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/background-image/">background-image</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/border/">border</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/border图形/">border图形</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/box-shadow/">box-shadow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/console-log/">console.log()</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css3/">css3</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css属性/">css属性</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css样式/">css样式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deferred/">deferred</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/delete/">delete</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/first-child/">first-child</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/first-of-type/">first-of-type</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/float/">float</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/font-face/">font-face</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/form表单/">form表单</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/get/">get</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitbash/">gitbash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git错误/">git错误</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hack/">hack</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/haslayout/">haslayout</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/">html</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http状态码/">http状态码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/inline-block/">inline-block</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/input/">input</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/instanceof/">instanceof</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/instanceof-typeof/">instanceof/typeof</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/json/">json</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js严格模式/">js严格模式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js加载/">js加载</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js模板引擎/">js模板引擎</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/list-style/">list-style</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/meta/">meta</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mock/">mock</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/offset/">offset()</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/overflow/">overflow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/placeholder/">placeholder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/position/">position</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/position文档流/">position文档流</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/post/">post</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scopechain/">scopechain</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stopImmediatePropagation/">stopImmediatePropagation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stringify/">stringify</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sublime/">sublime</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/this/">this</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/typeof/">typeof</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/undefined/">undefined</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/url加载/">url加载</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zoom/">zoom</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码书写/">代码书写</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/函数/">函数</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/列表/">列表</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动画animation/">动画animation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/变量/">变量</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/同源跨域/">同源跨域</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字符串/">字符串</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字面量/">字面量</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/库与架构/">库与架构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学函数/">数学函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据包组装/">数据包组装</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数组/">数组</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/方法/">方法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/标记语言/">标记语言</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模块化编程/">模块化编程</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/立即执行函数/">立即执行函数</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/简历/">简历</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网站访问/">网站访问</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/获取路径/">获取路径</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/行内元素/">行内元素</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语法/">语法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/跨域请求/">跨域请求</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/跨域请求处理方法/">跨域请求处理方法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/选择器/">选择器</a><span class="tag-list-count">1</span></li></ul>
              </li>
            
          
            
              <li class="archive-list-container">
                <a href="javascript:;">归档</a>
                <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">162</span></li></ul>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="/" title="Homepage">Homepage</a>
              </li>
            
          
            
              <li>
                <a href="/archives" title="By Year">By Year</a>
              </li>
            
          
            
              <li>
                <a href="/work" title="work">work</a>
              </li>
            
          
            
              <li>
                <a href="/about" title="about">about</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="http://findmoon.github.io/" title="findmoon" target="_blank" rel="external">findmoon</a>
              </li>
            
          
            
              <li>
                <a href="https://github.com/findmoon/findmoon.github.io" title="Github" target="_blank" rel="external">Github</a>
              </li>
            
          
        </ul>
      
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 1000px">
      
          

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/26/界面之下：还原真实的 MVC、MVP、MVVM 模式/" >
  界面之下：还原真实的 MVC、MVP、MVVM 模式
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/26/界面之下：还原真实的 MVC、MVP、MVVM 模式/"><span class="article-date">
  2016-05-26
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/web/">web</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MV模式/">MV模式</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>界面之下：还原真实的 MVC、MVP、MVVM 模式</p>
<p>转载自： <a href="https://github.com/livoras/blog/issues/11作者：" target="_blank" rel="external">https://github.com/livoras/blog/issues/11作者：</a> 戴嘉华</p>
<h2 id="GUI程序所面临的问题"><a href="#GUI程序所面临的问题" class="headerlink" title="GUI程序所面临的问题"></a>GUI程序所面临的问题</h2><p>图形界面的应用程序提供给用户可视化的操作界面，这个界面提供给数据和信息。用户输入行为（键盘，鼠标等）会执行一些应用逻辑，应用逻辑（application logic）可能会触发一定的业务逻辑（business logic）对应用程序数据的变更，数据的变更自然需要用户界面的同步变更以提供最准确的信息。例如用户对一个电子表格重新排序的操作，应用程序需要响应用户操作，对数据进行排序，然后需要同步到界面上。</p>
<p>在开发应用程序的时候，以求更好的管理应用程序的复杂性，基于职责分离（Speration of Duties）的思想都会对应用程序进行分层。在开发图形界面应用程序的时候，会把管理用户界面的层次称为View，应用程序的数据为Model（注意这里的Model指的是Domain Model，这个应用程序对需要解决的问题的数据抽象，不包含应用的状态，可以简单理解为对象）。Model提供数据操作的接口，执行相应的业务逻辑。</p>
<p><img src="/img/mvvm/687406e67.png" alt=""></p>
<p>有了View和Model的分层，那么问题就来了：View如何同步Model的变更，View和Model之间如何粘合在一起。</p>
<p>带着这个问题开始探索MV<em>模式，会发现这些模式之间的差异可以归纳为对这个问题处理的方式的不同。而几乎所有的MV</em>模式都是经典的Smalltalk-80 MVC的修改版。</p>
<h2 id="Smalltalk-80-MVC"><a href="#Smalltalk-80-MVC" class="headerlink" title="Smalltalk-80 MVC"></a>Smalltalk-80 MVC</h2><h3 id="历史背景"><a href="#历史背景" class="headerlink" title="历史背景"></a>历史背景</h3><p>早在上个世纪70年代，美国的施乐公司（Xerox）的工程师研发了Smalltalk编程语言，并且开始用它编写图形界面的应用程序。而在Smalltalk-80这个版本的时候，一位叫Trygve Reenskaug的工程师设计了MVC图形应用程序的架构模式，极大地降低了图形应用程序的管理难度。而在四人帮（GoF）的设计模式当中并没有把MVC当做是设计模式，而仅仅是把它看成解决问题的一些类的集合。Smalltalk-80 MVC和GoF描述的MVC是最经典的MVC模式。</p>
<h3 id="MVC的依赖关系"><a href="#MVC的依赖关系" class="headerlink" title="MVC的依赖关系"></a>MVC的依赖关系</h3><p>MVC出了把应用程序分成View、Model层，还额外的加了一个Controller层，它的职责为进行Model和View之间的协作（路由、输入预处理等）的应用逻辑（application logic）；Model进行处理业务逻辑。Model、View、Controller三个层次的依赖关系如下：</p>
<p><img src="/img/mvvm/32d6465702e706e67.png" alt=""></p>
<p>Controller和View都依赖Model层，Controller和View可以互相依赖。在一些网上的资料Controller和View之间的依赖关系可能不一样，有些是单向依赖，有些是双向依赖，这个其实关系不大，后面会看到它们的依赖关系都是为了把处理用户行为触发的事件处理权交给Controller。</p>
<h3 id="MVC的调用关系"><a href="#MVC的调用关系" class="headerlink" title="MVC的调用关系"></a>MVC的调用关系</h3><p>用户的对View操作以后，View捕获到这个操作，会把处理的权利交移给Controller（Pass calls）；Controller会对来自View数据进行预处理、决定调用哪个Model的接口；然后由Model执行相关的业务逻辑；当Model变更了以后，会通过观察者模式（Observer Pattern）通知View；View通过观察者模式收到Model变更的消息以后，会向Model请求最新的数据，然后重新更新界面。如下图：</p>
<p><img src="/img/mvvm/d76632d6361706e67.png" alt=""></p>
<p>看似没有什么特别的地方，但是由几个需要特别关注的关键点：</p>
<ol>
<li>View是把控制权交移给Controller，Controller执行应用程序相关的应用逻辑（对来自View数据进行预处理、决定调用哪个Model的接口等等）。</li>
<li>Controller操作Model，Model执行业务逻辑对数据进行处理。但不会直接操作View，可以说它是对View无知的。</li>
<li>View和Model的同步消息是通过观察者模式进行，而同步操作是由View自己请求Model的数据然后对视图进行更新。</li>
</ol>
<p>需要特别注意的是MVC模式的精髓在于第三点：Model的更新是通过观察者模式告知View的，具体表现形式可以是Pub/Sub或者是触发Events。而网上很多对于MVC的描述都没有强调这一点。通过观察者模式的好处就是：不同的MVC三角关系可能会有共同的Model，一个MVC三角中的Controller操作了Model以后，两个MVC三角的View都会接受到通知，然后更新自己。保持了依赖同一块Model的不同View显示数据的实时性和准确性。我们每天都在用的观察者模式，在几十年前就已经被大神们整合到MVC的架构当中。</p>
<p>这里有一个MVC模式的JavaScript Demo，实现了一个小的TodoList应用程序。经典的Smalltalk-80 MVC不需要任何框架支持就可以实现。目前Web前端框架当中只有一个号称是严格遵循Smalltalk-80 MVC模式的：maria.js。</p>
<h4 id="MVC的优缺点"><a href="#MVC的优缺点" class="headerlink" title="MVC的优缺点"></a>MVC的优缺点</h4><p>优点：</p>
<ol>
<li>把业务逻辑和展示逻辑分离，模块化程度高。且当应用逻辑需要变更的时候，不需要变更业务逻辑和展示逻辑，只需要Controller换成另外一个Controller就行了（Swappable Controller）。</li>
<li>观察者模式可以做到多视图同时更新。</li>
</ol>
<p>缺点：</p>
<ol>
<li>Controller测试困难。因为视图同步操作是由View自己执行，而View只能在有UI的环境下运行。在没有UI环境下对Controller进行单元测试的时候，应用逻辑正确性是无法验证的：Model更新的时候，无法对View的更新操作进行断言。</li>
<li>View无法组件化。View是强依赖特定的Model的，如果需要把这个View抽出来作为一个另外一个应用程序可复用的组件就困难了。因为不同程序的的Domain Model是不一样的</li>
</ol>
<h3 id="MVC-Model-2"><a href="#MVC-Model-2" class="headerlink" title="MVC Model 2"></a>MVC Model 2</h3><p>在Web服务端开发的时候也会接触到MVC模式，而这种MVC模式不能严格称为MVC模式。经典的MVC模式只是解决客户端图形界面应用程序的问题，而对服务端无效。服务端的MVC模式又自己特定的名字：MVC Model 2，或者叫JSP Model 2，或者直接就是Model 2 。Model 2客户端服务端的交互模式如下：</p>
<p><img src="/img/mvvm/64656c322e706e67.png" alt=""></p>
<p>服务端接收到来自客户端的请求，服务端通过路由规则把这个请求交由给特定的Controller进行处理，Controller执行相应的应用逻辑，对Model进行操作，Model执行业务逻辑以后；然后用数据去渲染特定的模版，返回给客户端。</p>
<p>因为HTTP协议是单工协议并且是无状态的，服务器无法直接给客户端推送数据。除非客户端再次发起请求，否则服务器端的Model的变更就无法告知客户端。所以可以看到经典的Smalltalk-80 MVC中Model通过观察者模式告知View更新这一环被无情地打破，不能称为严格的MVC。</p>
<p>Model 2模式最早在1998年应用在JSP应用程序当中，JSP Model 1应用管理的混乱诱发了JSP参考了客户端MVC模式，催生了Model 2。</p>
<p><img src="/img/mvvm/06e67.png" alt=""></p>
<p>后来这种模式几乎被应用在所有语言的Web开发框架当中。PHP的ThinkPHP，Python的Dijango、Flask，NodeJS的Express，Ruby的RoR，基本都采纳了这种模式。平常所讲的MVC基本是这种服务端的MVC。</p>
<h2 id="MVP"><a href="#MVP" class="headerlink" title="MVP"></a>MVP</h2><p>MVP模式有两种：</p>
<ol>
<li>Passive View</li>
<li>Supervising Controller</li>
</ol>
<p>而大多数情况下讨论的都是Passive View模式。本文会对PV模式进行较为详细的介绍，而SC模式则简单提及。</p>
<h3 id="历史背景-1"><a href="#历史背景-1" class="headerlink" title="历史背景"></a>历史背景</h3><p>MVP模式是MVC模式的改良。在上个世纪90年代，IBM旗下的子公司Taligent在用C/C++开发一个叫CommonPoint的图形界面应用系统的时候提出来的。</p>
<h3 id="MVP（Passive-View）的依赖关系"><a href="#MVP（Passive-View）的依赖关系" class="headerlink" title="MVP（Passive View）的依赖关系"></a>MVP（Passive View）的依赖关系</h3><p>MVP模式把MVC模式中的Controller换成了Presenter。MVP层次之间的依赖关系如下：</p>
<p><img src="/img/mvvm/e706e67.png" alt=""></p>
<p>MVP打破了View原来对于Model的依赖，其余的依赖关系和MVC模式一致。</p>
<h3 id="MVP（Passive-View）的调用关系"><a href="#MVP（Passive-View）的调用关系" class="headerlink" title="MVP（Passive View）的调用关系"></a>MVP（Passive View）的调用关系</h3><p>既然View对Model的依赖被打破了，那View如何同步Model的变更？看看MVP的调用关系：</p>
<p><img src="/img/mvvm/c6c2e706e67.png" alt=""></p>
<p>和MVC模式一样，用户对View的操作都会从View交移给Presenter。Presenter会执行相应的应用程序逻辑，并且对Model进行相应的操作；而这时候Model执行完业务逻辑以后，也是通过观察者模式把自己变更的消息传递出去，但是是传给Presenter而不是View。Presenter获取到Model变更的消息以后，通过View提供的接口更新界面。</p>
<p>关键点：</p>
<ol>
<li>View不再负责同步的逻辑，而是由Presenter负责。Presenter中既有应用程序逻辑也有同步逻辑。</li>
<li>View需要提供操作界面的接口给Presenter进行调用。（关键）</li>
</ol>
<p>对比在MVC中，Controller是不能操作View的，View也没有提供相应的接口；而在MVP当中，Presenter可以操作View，View需要提供一组对界面操作的接口给Presenter进行调用；Model仍然通过事件广播自己的变更，但由Presenter监听而不是View。</p>
<p>MVP模式，这里也提供一个用JavaScript编写的例子。</p>
<h3 id="MVP（Passive-View）的优缺点"><a href="#MVP（Passive-View）的优缺点" class="headerlink" title="MVP（Passive View）的优缺点"></a>MVP（Passive View）的优缺点</h3><p>优点：</p>
<ol>
<li>便于测试。Presenter对View是通过接口进行，在对Presenter进行不依赖UI环境的单元测试的时候。可以通过Mock一个View对象，这个对象只需要实现了View的接口即可。然后依赖注入到Presenter中，单元测试的时候就可以完整的测试Presenter应用逻辑的正确性。这里根据上面的例子给出了Presenter的单元测试样例。</li>
<li>View可以进行组件化。在MVP当中，View不依赖Model。这样就可以让View从特定的业务场景中脱离出来，可以说View可以做到对业务完全无知。它只需要提供一系列接口提供给上层操作。这样就可以做到高度可复用的View组件。</li>
</ol>
<p>缺点：</p>
<ol>
<li>Presenter中除了应用逻辑以外，还有大量的View-&gt;Model，Model-&gt;View的手动同步逻辑，造成Presenter比较笨重，维护起来会比较困难。</li>
</ol>
<h3 id="MVP（Supervising-Controller）"><a href="#MVP（Supervising-Controller）" class="headerlink" title="MVP（Supervising Controller）"></a>MVP（Supervising Controller）</h3><p>上面讲的是MVP的Passive View模式，该模式下View非常Passive，它几乎什么都不知道，Presenter让它干什么它就干什么。而Supervising Controller模式中，Presenter会把一部分简单的同步逻辑交给View自己去做，Presenter只负责比较复杂的、高层次的UI操作，所以可以把它看成一个Supervising Controller。</p>
<p>Supervising Controller模式下的依赖和调用关系：</p>
<p><img src="/img/mvvm/66f72617327.png" alt=""></p>
<p>因为Supervising Controller用得比较少，对它的讨论就到这里为止。</p>
<h2 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h2><p>MVVM可以看作是一种特殊的MVP（Passive View）模式，或者说是对MVP模式的一种改良。</p>
<h3 id="历史背景-2"><a href="#历史背景-2" class="headerlink" title="历史背景"></a>历史背景</h3><p>MVVM模式最早是微软公司提出，并且了大量使用在.NET的WPF和Sliverlight中。2005年微软工程师John Gossman在自己的博客上首次公布了MVVM模式。</p>
<h3 id="ViewModel"><a href="#ViewModel" class="headerlink" title="ViewModel"></a>ViewModel</h3><p>MVVM代表的是Model-View-ViewModel，这里需要解释一下什么是ViewModel。ViewModel的含义就是 “Model of View”，视图的模型。它的含义包含了领域模型（Domain Model）和视图的状态（State）。 在图形界面应用程序当中，界面所提供的信息可能不仅仅包含应用程序的领域模型。还可能包含一些领域模型不包含的视图状态，例如电子表格程序上需要显示当前排序的状态是顺序的还是逆序的，而这是Domain Model所不包含的，但也是需要显示的信息。</p>
<p>可以简单把ViewModel理解为页面上所显示内容的数据抽象，和Domain Model不一样，ViewModel更适合用来描述View。</p>
<h3 id="MVVM的依赖"><a href="#MVVM的依赖" class="headerlink" title="MVVM的依赖"></a>MVVM的依赖</h3><p>MVVM的依赖关系和MVP依赖，只不过是把P换成了VM。</p>
<p><img src="/img/mvvm/e696f2f66e67.png" alt=""></p>
<h3 id="MVVM的调用关系"><a href="#MVVM的调用关系" class="headerlink" title="MVVM的调用关系"></a>MVVM的调用关系</h3><p>MVVM的调用关系和MVP一样。但是，在ViewModel当中会有一个叫Binder，或者是Data-binding engine的东西。以前全部由Presenter负责的View和Model之间数据同步操作交由给Binder处理。你只需要在View的模版语法当中，指令式地声明View上的显示的内容是和Model的哪一块数据绑定的。当ViewModel对进行Model更新的时候，Binder会自动把数据更新到View上去，当用户对View进行操作（例如表单输入），Binder也会自动把数据更新到Model上去。这种方式称为：Two-way data-binding，双向数据绑定。可以简单而不恰当地理解为一个模版引擎，但是会根据数据变更实时渲染。</p>
<p><img src="/img/mvvm/632f6d76766.png" alt=""></p>
<p>也就是说，MVVM把View和Model的同步逻辑自动化了。以前Presenter负责的View和Model同步不再手动地进行操作，而是交由框架所提供的Binder进行负责。只需要告诉Binder，View显示的数据对应的是Model哪一部分即可。</p>
<p>这里有一个JavaScript MVVM的例子，因为MVVM需要Binder引擎。所以例子中使用了一个MVVM的库：<a href="https://github.com/livoras/MVW-demos/blob/master/src/scripts/mvvm.js" target="_blank" rel="external">Vue.js</a>。</p>
<h3 id="MVVM的优缺点"><a href="#MVVM的优缺点" class="headerlink" title="MVVM的优缺点"></a>MVVM的优缺点</h3><p>优点：</p>
<ol>
<li>提高可维护性。解决了MVP大量的手动View和Model同步的问题，提供双向绑定机制。提高了代码的可维护性。</li>
<li>简化测试。因为同步逻辑是交由Binder做的，View跟着Model同时变更，所以只需要保证Model的正确性，View就正确。大大减少了对View同步更新的测试。</li>
</ol>
<p>缺点：</p>
<ol>
<li>过于简单的图形界面不适用，或说牛刀杀鸡。</li>
<li>对于大型的图形应用程序，视图状态较多，ViewModel的构建和维护的成本都会比较高。</li>
<li>数据绑定的声明是指令式地写在View的模版当中的，这些内容是没办法去打断点debug的。</li>
</ol>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>可以看到，从MVC-&gt;MVP-&gt;MVVM，就像一个打怪升级的过程。后者解决了前者遗留的问题，把前者的缺点优化成了优点。同样的Demo功能，代码从最开始的一堆文件，优化成了最后只需要20几行代码就完成。MV*模式之间的区分还是蛮清晰的，希望可以给对这些模式理解比较模糊的同学带来一些参考和思路。</p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/26/web开发的MVVM模式/" >
  web开发的MVVM模式
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/26/web开发的MVVM模式/"><span class="article-date">
  2016-05-26
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/web/">web</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MV模式/">MV模式</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p><a href="http://www.cnblogs.com/dxy1982/p/3793895.html" target="_blank" rel="external">web开发的MVVM模式*转</a></p>
<h2 id="MVC-VS-MVP-VS-MVVM"><a href="#MVC-VS-MVP-VS-MVVM" class="headerlink" title="MVC VS. MVP VS. MVVM"></a>MVC VS. MVP VS. MVVM</h2><p>　　了解MVVM模式之前，我们先来简单了解一下从MVC到MVVM的变迁。这个变迁是耦合从紧到松的变迁，是对依赖处理的进化，是应对变化技术的成熟。 </p>
<h2 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h2><p>　　MVC全名是Model View Controller， 是模型(model)－视图(view)－控制器(controller)的缩写，它用一种将业务逻辑、数据、界面显示分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进和个性化定制界面及用户交互的同时，不需要重新编写业务逻辑。将系统进行MVC分层的核心思路就是分离组件，降低组件耦合性，组件独立演化。 </p>
<ul>
<li>MVC模式可以使用下面这幅图来描述各个部分的作用以及与其他组件的交互过程： </li>
</ul>
<p><img src="/img/mvvm/311314546808310.png" alt=""></p>
<p>MVC模式的优点很明显，那就是耦合性低，重用性高，应对每个组件的变化性好，便于开发，测试与维护。但是MVC模式也还是有缺点的，给系统带来的额外复杂性自然不必说了，此外，MVC三个组件的定义存在一定的模糊性，这样就衍生了很多的比如主动MVC，被动MVC等实施方案，每种方案中MVC三大组件的功能都不太一样，比如有的把业务逻辑放到Model部分，Controller只不过是把用户输入转换一下，直接传给Model来处理，Model是整个系统的核心部分，上面这幅图就是这样的(这种情况其实就是真正的MVC模式的定义)，还有的方案把业务逻辑直接放到了Controller中，Model只负责处理数据。而且在不同的方案中，要么View与Controller耦合过于紧密，要么View访问Model的时候比较低效，要么Model由于要与View直接打交道，导致了Model与View直接耦合在了一起，而Model发生变化的时候会牵连View一起变化，这却恰恰违背了MVC组件分层的本意。 </p>
<h2 id="MVP"><a href="#MVP" class="headerlink" title="MVP"></a>MVP</h2><p>　　MVP的全称为Model-View-Presenter，Model提供数据，View负责显示，Presenter负责逻辑的处理。MVP与MVC有着一个重大的区别：在MVP中View并不直接使用Model，它们之间的通信是通过Presenter来进行的，所有的交互都发生在Presenter内部，而在MVC中View会直接从Model中读取数据而不是通过Controller。 </p>
<ul>
<li>MVP模式可以使用下面这幅图来描述各个部分的作用以及与其他组件的交互过程： </li>
</ul>
<p><img src="/img/mvvm/311315046801589.png" alt=""></p>
<p>在MVC里，我们谈到它的缺点主要有两个： </p>
<ul>
<li><p>一个是MVC三大组件的定义比较模糊。这个在MVP中就相对明确一些了：Model只负责处理最终数据；View就是很薄的一层，只显示数据，通常认为，View只应该有简单的Set/Get的方法，View只负责用户输入和设置界面显示的内容，除此就不应该有更多的内容，绝不容许直接访问Model；所有业务逻辑都由Presenter处理，而且，Presenter与具体的View和Model是没有直接关联的，而是通过定义好的接口进行交互，从而使得在变更View或者Model具体实现的时候可以保持Presenter的不变，这样就实现了业务逻辑的重用。 </p>
</li>
<li><p>另一个是View与Model的紧密耦合。在MVC中，View是可以直接访问Model的！从而，View里会包含Model信息，不可避免的还要包括一些业务逻辑。 在MVC模型里，更关注的Model的不变，而同时有多个对Model的不同显示，及View。所以，在MVC模型里，Model不依赖于View，但是View是依赖于Model的。不仅如此，因为有一些业务逻辑在View里实现了，导致要更改View也是比较困难的，至少那些业务逻辑是无法重用的。 </p>
</li>
</ul>
<p>在现实中，MVP的实现会根据View的充、贫血而有一些不同，一部分倾向于在View中放置简单的逻辑，在Presenter放置复杂的逻辑；另一部分倾向于在presenter中放置全部的逻辑。这两种分别被称为：Passive View和Superivising Controller。 </p>
<p>在Passive View中，为了减少UI组件的行为，使用Controller不仅控制用户事件的响应，而且将结果更新到View上。可以集中测试Controller，减小View出问题的风险。 </p>
<p>在Superivising Controller中的Controller既处理用户输入的响应，又操作View处理View的复杂逻辑。 </p>
<p>　　MVP解决了MVC的一些问题，其实现在说到MVC，通常指的也就是MVP。但是MVP也是不完美的，由于Presenter可以反作用于View，这样View的渲染有可能就放在了Presenter中，所以View和Presenter的交互会过于频繁。如果Presenter过多地渲染了View，往往会使得它与特定的View的联系过于紧密。一旦View需要变更，那么Presenter也需要变更了。 </p>
<h2 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h2><p>　　MVVM全称Model-View-ViewModel，Model提供数据，View负责显示，这个还和MVP一样，这个模式的重点就是ViewModel的部分，它通过双向绑定(松耦合)解决了MVP中Presenter与View联系比较紧密的问题。 </p>
<ul>
<li>MVVM模式可以使用下面这幅图来描述各个部分的作用以及与其他组件的交互过程： </li>
</ul>
<p><img src="/img/mvvm/311315165713023.png" alt=""></p>
<p>从图中我们可以看到MVVM与MVP最大的不同就在于View与ViewModel交互的时候使用了松耦合的双向绑定，而不是像View与Presenter那样直接交互。ViewModel作为View的数据映射，通常View上有什么属性，ViewModel上也会存在相应的一个属性，这两个属性通过事件实现了双向的绑定，常见的MVVM框架都替我们完成了这样的绑定过程。<br>　　MVVM最初是微软在WPF中实现的模式，随之在Web开发中也开始了MVVM风潮，这里介绍的3个MVVM框架就是我认为比较典型的几个。 </p>
<h3 id="微软的前端框架knockoutjs"><a href="#微软的前端框架knockoutjs" class="headerlink" title="微软的前端框架knockoutjs"></a>微软的前端框架knockoutjs</h3><p>　　这是一个独立的前端MVVM框架，也是最早的前端MVVM框架，它完成了页面的数据与界面之间的双向绑定，至于真正这些数据是通过何种手段(比如Ajax)获取到的，它并不关心。这是一个只关注前端逻辑与界面解耦的纯前端类库，理论上可以搭配任何的后台技术，来完成整个网站的建设。这是我第一个学习的MVVM框架，使用它给我的感觉是相当良好：绑定好了自动双向更新是多么酷的特性啊。 </p>
<ul>
<li>下面是比较火热的几个学习教程： <blockquote>
<p><a href="http://knockoutjs.com/" target="_blank" rel="external">http://knockoutjs.com/</a><br><a href="http://www.cnblogs.com/TomXu/archive/2011/11/21/2257154.html" target="_blank" rel="external">http://www.cnblogs.com/TomXu/archive/2011/11/21/2257154.html</a><br><a href="http://www.cnblogs.com/lori/p/3552571.html" target="_blank" rel="external">http://www.cnblogs.com/lori/p/3552571.html</a> </p>
</blockquote>
</li>
</ul>
<h3 id="谷歌的全套服务angularjs"><a href="#谷歌的全套服务angularjs" class="headerlink" title="谷歌的全套服务angularjs"></a>谷歌的全套服务angularjs</h3><p>　　这是一个比较庞大，但是也无比强大的前端MVVM类库，天生对RESTful API的良好支持，双向绑定的优良特性，专业的HTML模板扩展支持，全面的测试框架，与Bootstrap，Nodejs的完美融合，再加上Google的金字招牌，你可以拒绝么？ </p>
<ul>
<li>下面是比较火热的教程： <blockquote>
<p><a href="https://angularjs.org/" target="_blank" rel="external">https://angularjs.org/</a><br><a href="http://www.ituring.com.cn/minibook/303" target="_blank" rel="external">http://www.ituring.com.cn/minibook/303</a><br><a href="http://www.iteye.com/news/28651-AngularJS-Google-resource" target="_blank" rel="external">http://www.iteye.com/news/28651-AngularJS-Google-resource</a><br><a href="http://woxx.sinaapp.com/" target="_blank" rel="external">http://woxx.sinaapp.com/</a><br><a href="http://www.angularjs.cn/tag/AngularJS" target="_blank" rel="external">http://www.angularjs.cn/tag/AngularJS</a> </p>
</blockquote>
</li>
</ul>
<h3 id="最迷你的MVVM框架avalon"><a href="#最迷你的MVVM框架avalon" class="headerlink" title="最迷你的MVVM框架avalon"></a>最迷你的MVVM框架avalon</h3><p>　　这确实是最mini的MVVM框架，与Angularjs不一样，它侧重数据结构的设计，提倡简单的算法，它是在吸收上面两个类库的基础上发展起来的，而且符合国情，支持IE6，难道不值得期待？ </p>
<ul>
<li>下面是比较好的教程： <blockquote>
<p><a href="http://rubylouvre.github.io/mvvm/" target="_blank" rel="external">http://rubylouvre.github.io/mvvm/</a><br><a href="http://limodou.github.io/avalon-learning/zh_CN/index.html" target="_blank" rel="external">http://limodou.github.io/avalon-learning/zh_CN/index.html</a><br><a href="http://www.cnblogs.com/rubylouvre/p/3181291.html" target="_blank" rel="external">http://www.cnblogs.com/rubylouvre/p/3181291.html</a><br><a href="http://www.oschina.net/p/avalon" target="_blank" rel="external">http://www.oschina.net/p/avalon</a><br><a href="http://www.iteye.com/topic/1130359" target="_blank" rel="external">http://www.iteye.com/topic/1130359</a><br><a href="http://www.tuicool.com/articles/NrMrIn" target="_blank" rel="external">http://www.tuicool.com/articles/NrMrIn</a> </p>
</blockquote>
</li>
</ul>
<p>最后附送一个有意思的网站：<a href="http://todomvc.com/，自己研究一下吧。" target="_blank" rel="external">http://todomvc.com/，自己研究一下吧。</a></p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/25/font-face/" >
  CSS3 @font-face
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/25/font-face/"><span class="article-date">
  2016-05-25
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/CSS3/">CSS3</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/font-face/">font-face</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>(转)CSS3 @font-face<br><a href="http://www.cnblogs.com/rubylouvre/archive/2011/06/19/2084875.html" target="_blank" rel="external">原文地址</a></p>
<p><a href="http://www.fontsquirrel.com/fontface" target="_blank" rel="external">http://www.fontsquirrel.com/fontface</a></p>
<p>@font-face是CSS3中的一个模块，他主要是把自己定义的Web字体嵌入到你的网页中，随着@font-face模块的出现，我们在Web的开发中使用字体不怕只能使用Web安全字体，你们当中或许有许多人会不自然的问，这样的东西IE能支持吗？当我告诉大家@font-face这个功能早在IE4就支持了你肯定会感到惊讶。我的Blog就使用了许多这样的自定义Web字体，比如说首页的Logo，Tags以及页面中的手写英文体，很多朋友问我如何使用，能让自己的页面也支持这样的自定义字体，一句话这些都是@font-face实现的，为了能让更多的朋友知道如何使用他，今天我主要把自己的一点学习过程贴上来和大家分享。</p>
<p>首先我们一起来看看@font-face的语法规则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@font-face &#123;</span><br><span class="line">   font-family: &lt;YourWebFontName&gt;;</span><br><span class="line">   src: &lt;source&gt; [&lt;format&gt;][,&lt;source&gt; [&lt;format&gt;]]*;</span><br><span class="line">   [font-weight: &lt;weight&gt;];</span><br><span class="line">   [font-style: &lt;style&gt;];</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>取值说明</p>
<p>YourWebFontName:此值指的就是你自定义的字体名称，最好是使用你下载的默认字体，他将被引用到你的Web元素中的font-family。如“font-family:”YourWebFontName”;”<br>source:此值指的是你自定义的字体的存放路径，可以是相对路径也可以是绝路径；<br>format：此值指的是你自定义的字体的格式，主要用来帮助浏览器识别，其值主要有以下几种类型：truetype,opentype,truetype-aat,embedded-opentype,avg等；<br>weight和style:这两个值大家一定很熟悉，weight定义字体是否为粗体，style主要定义字体样式，如斜体。<br>兼容浏览器</p>
<p>说到浏览器对@font-face的兼容问题，这里涉及到一个字体format的问题，因为不同的浏览器对字体格式支持是不一致的，这样大家有必要了解一下，各种版本的浏览器支持什么样的字体，前面也简单带到了有关字体的几种格式，下面我就分别说一下这个问题，让大家心里有一个概念：</p>
<p>一、TureTpe(.ttf)格式：</p>
<p>.ttf字体是Windows和Mac的最常见的字体，是一种RAW格式，因此他不为网站优化,支持这种字体的浏览器有【IE9+,Firefox3.5+,Chrome4+,Safari3+,Opera10+,iOS Mobile Safari4.2+】；</p>
<p>二、OpenType(.otf)格式：</p>
<p>.otf字体被认为是一种原始的字体格式，其内置在TureType的基础上，所以也提供了更多的功能,支持这种字体的浏览器有【Firefox3.5+,Chrome4.0+,Safari3.1+,Opera10.0+,iOS Mobile Safari4.2+】；</p>
<p>三、Web Open Font Format(.woff)格式：</p>
<p>.woff字体是Web字体中最佳格式，他是一个开放的TrueType/OpenType的压缩版本，同时也支持元数据包的分离,支持这种字体的浏览器有【IE9+,Firefox3.5+,Chrome6+,Safari3.6+,Opera11.1+】；</p>
<p>四、Embedded Open Type(.eot)格式：</p>
<p>.eot字体是IE专用字体，可以从TrueType创建此格式字体,支持这种字体的浏览器有【IE4+】；</p>
<p>五、SVG(.svg)格式：</p>
<p>.svg字体是基于SVG字体渲染的一种格式,支持这种字体的浏览器有【Chrome4+,Safari3.1+,Opera10.0+,iOS Mobile Safari3.2+】。</p>
<p>这就意味着在@font-face中我们至少需要.woff,.eot两种格式字体，甚至还需要.svg等字体达到更多种浏览版本的支持。</p>
<p>为了使@font-face达到更多的浏览器支持，Paul Irish写了一个独特的@font-face语法叫Bulletproof @font-face:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  @font-face &#123;</span><br><span class="line">font-family: &apos;YourWebFontName&apos;;</span><br><span class="line">src: url(&apos;YourWebFontName.eot?&apos;) format(&apos;eot&apos;);/*IE*/</span><br><span class="line">src:url(&apos;YourWebFontName.woff&apos;) format(&apos;woff&apos;), url(&apos;YourWebFontName.ttf&apos;) format(&apos;truetype&apos;);/*non-IE*/</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>但为了让各多的浏览器支持，你也可以写成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  @font-face &#123;</span><br><span class="line">font-family: &apos;YourWebFontName&apos;;</span><br><span class="line">src: url(&apos;YourWebFontName.eot&apos;); /* IE9 Compat Modes */</span><br><span class="line">src: url(&apos;YourWebFontName.eot?#iefix&apos;) format(&apos;embedded-opentype&apos;), /* IE6-IE8 */</span><br><span class="line">            url(&apos;YourWebFontName.woff&apos;) format(&apos;woff&apos;), /* Modern Browsers */</span><br><span class="line">            url(&apos;YourWebFontName.ttf&apos;)  format(&apos;truetype&apos;), /* Safari, Android, iOS */</span><br><span class="line">            url(&apos;YourWebFontName.svg#YourWebFontName&apos;) format(&apos;svg&apos;); /* Legacy iOS */</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>说了这么多空洞的理论知识，大家一定有点心痒痒了，那么我们先来看看W3CPLUS首页中导航部分的兰色字体是如何实现的，假如我们有一个这样的DOM标签，需要应用自定义字体：</p>
<p>HTML Code:</p>
<p>&lt; h2 class=”neuesDemo”&gt;Neues Bauen Demo&lt; /h2&gt;<br>通过@font-face来定义自己的Web Font:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@font-face &#123;</span><br><span class="line">  font-family: &apos;NeuesBauenDemo&apos;;</span><br><span class="line">  src: url(&apos;../fonts/neues_bauen_demo-webfont.eot&apos;);</span><br><span class="line">  src: url(&apos;../fonts/neues_bauen_demo-webfont.eot?#iefix&apos;) format(&apos;embedded-opentype&apos;),</span><br><span class="line">   url(&apos;../fonts/neues_bauen_demo-webfont.woff&apos;) format(&apos;woff&apos;),</span><br><span class="line">   url(&apos;../fonts/neues_bauen_demo-webfont.ttf&apos;) format(&apos;truetype&apos;),</span><br><span class="line">   url(&apos;../fonts/neues_bauen_demo-webfont.svg#NeuesBauenDemo&apos;) format(&apos;svg&apos;);</span><br><span class="line">  font-weight: normal;</span><br><span class="line">  font-style: normal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我在这里采用的是相对路径，当然大家也可以使用绝路径。到这里我们就需要把定义好的字体应用到我们实际页面中去：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">h2.neuesDemo &#123;</span><br><span class="line">   font-family: &apos;NeuesBauenDemo&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>效果：<br><img src="/img/fontface/o_neues-bauen-demo.jpg" alt=""></p>
<p>看到上面的效果，我想大家会感到@font-face很神奇，同时也想争着做做看，可是一动手才发现，特殊字体我要怎样才能得到，那些.eot,.woff,.ttf,.svg这些字体格式又怎么获取呢？有些朋友可能就不知道如何运手了，那么我们就带着这些问题来一个全程完成的实例吧：</p>
<p>一、获取特殊字体：</p>
<p>我们拿下面这种single Malta字体来说吧：</p>
<p><img src="/img/fontface/o_font-face-single-malta-demo.jpg" alt=""></p>
<p>要得到single Malta字体，不外乎两种途径，其一找到付费网站购买字体，其二就是到免费网站DownLoad字体。当然要给钱的这种傻事我想大家都不会做的，那我们就得到免费的地方下载，在哪有呢？我平时都是到<a href="http://www.google.com/webfonts" target="_blank" rel="external">Google Web Fonts</a>和<a href="http://www.dafont.com/" target="_blank" rel="external">Dafont.com</a>寻找自己需要的字体，当然网上也还有别的下载字体的地方，这个Demo使用的是Dafont.com的Single Malta字体，这样就可以到这里下载<a href="http://www.dafont.com/single-malta.font" target="_blank" rel="external">Single Malta</a>：</p>
<p><img src="/img/fontface/o_single-malta-font.jpg" alt=""></p>
<p>二、获取@font-face所需字体格式：</p>
<p>特殊字体已经在你的电脑中了，现在我们需要想办法获得@font-face所需的.eot,.woff,.ttf,.svg字体格式。要获取这些字体格式，我们同样是需要第三方工具或者软件来实现，下面我给大家推荐一款我常用的一个工具fontsquirrel,别的先不多说，首跟我点这里进入到下面这个界面吧。</p>
<p><img src="/img/fontface/o_font-face-kit-generator.png" alt=""></p>
<p>如果你进入页面没有看到上图，你可以直接点击导航:</p>
<p>如果你看到了上面的界面，那就好办了，我们来看如何应用这个工具生成@font-face需要的各种字体，先把我们刚才下载的字体上传上去：</p>
<p><img src="/img/fontface/o_add-fonts.jpg" alt=""></p>
<p>大家可以看到，解压缩出来的文件格式，里面除了@font-face所需要的字体格式外，还带有一个DEMO文件，如果你不清楚的也可以参考下载下来的DEMO文件，我在这里不对DEMO说明问题，我主要是给大家介绍如何把下载下来的文件有价值的运用到我们的项目中。</p>
<p>例如在自己的本地创建了一个fontface项目：</p>
<p>为了让项目结构更清晰，我们在项目中单独创建一个fonts目录，用来放置解压缩出来@font-face所需的字体格式：<br><img src="/img/fontface/o_font-face-project-demo.jpg" alt=""></p>
<p>现在@font-face所需字体已经加载到本地项目，现在本地项目中的style.css中附上我们需要的@font-face样式</p>
<p>@font-face {<br>   font-family: ‘SingleMaltaRegular’;<br>   src: url(‘../fonts/singlemalta-webfont.eot’);<br>   src: url(‘../fonts/singlemalta-webfont.eot?#iefix’) format(‘embedded-opentype’),<br>        url(‘../fonts/singlemalta-webfont.woff’) format(‘woff’),<br>    url(‘../fonts/singlemalta-webfont.ttf’) format(‘truetype’),<br>    url(‘../fonts/singlemalta-webfont.svg#SingleMaltaRegular’) format(‘svg’);<br>   font-weight: normal;<br>   font-style: normal;<br>}<br>到这里为止，我们已经通过@font-face自定义好所需的SingleMalta字体，离最后效果只差一步了，就是把自己定义的字体应用到你的Web中的DOM元素上：</p>
<p>h2.singleMalta {<br>  font-family: ‘SingleMaltaRegular’<br>}</p>
<p>看到上面的效果，那大家就知道我们实现成功了。那么关于@font-face帮你打造特殊效果的字体，到这里基本上就完成了，我在这里需要提醒使用者：</p>
<p>1、如果你的项目中是英文网站，而且项目中的Logo，Tags等应用到较多的这种特殊字体效果，我建议你不要使用图片效果，而使用@font-face，但是你是中文网站，我觉得还是使用图片比较合适，因为加载英文字体和图片没有多大区别，但是你加载中文字体，那就不一样了，因为中文字体太大了，这样会影响到项目的某些性能的优化；</p>
<p>2、致命的错误，你在@font-face中定义时，文件路径没有载对；</p>
<p>3、你只定义了@font-face，但并没有应用到你的项目中的DOM元素上；</p>
<p>以上几点都是在平时制作中常出现的问题，希望大家能小意一些，另外我们没有办法在购买所有字体，就算你实力雄厚，那也没有办法在一台服务器主机上放置你所有项目需要的字体。因此我给大家提供几个免费字体下载的网址：Webfonts,Typekit,Kernest,Google Web Fonts,Kernest,Dafont,Niec Web Type,不然你点这里将有更多的免费字体。前面几个链接是帮助你获取一些优美的怪异的特殊字体，但下面这个工具作用更是无穷的大，他能帮你生成@font-face所需要的各种字体，这工具就是Font Squirrel。</p>
<p>最后在提醒一下，使用@font-face别的可以忘了，但Font Squirrel千万不能忘，因为他能帮你生成@font-face所需的各种字体格式。</p>
<p>到此关于@font-face就介绍完了，不知道大家喜欢不喜欢，如果喜欢的话赶快动手实践一下，有Blog的可以马上运用上去，也可以炫一下。</p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/25/库与架构/" >
  库和框架区别
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/25/库与架构/"><span class="article-date">
  2016-05-25
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/jQ/">jQ</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/库与架构/">库与架构</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <h1 id="库和框架区别"><a href="#库和框架区别" class="headerlink" title="库和框架区别"></a>库和框架区别</h1><p>库和框架都是一种有别于软件、面向程序开发者的产品形式。正因为如此，也有很多人误以为库就是框架，或者认为指定语言的库就是框架。</p>
<p>库的英语为 Library ( 简写 Lib )，框架的英语为 Framework。</p>
<p>库是将代码集合成的一个产品，供程序员调用。面向对象的代码组织形式而成的库也叫类库。面向过程的代码组织形式而成的库也叫函数库。<br>在函数库中的可直接使用的函数叫库函数。开发者在使用库的时候，只需要使用库的一部分类或函数，然后继续实现自己的功能。</p>
<p>框架则是为解决一个(一类)问题而开发的产品，框架用户一般只需要使用框架提供的类或函数，即可实现全部功能。可以说，框架是库的升级版。<br>开发者在使用框架的时候，必须使用这个框架的全部代码。</p>
<p>库是一些方法的集合，避免定义重复功能的函数并具有一定的模式兼容性。类似于一个工具箱，里面有很多的工具，比如jQuery，可以很方便的调用里面的方法和函数，实现一些功能。<br>框架更应该是一种对开发者的规范，开发者按照框架的设计去实现以下功能或效果，并非简单的工具集的概念，框架可以提供相应的库或者基于库来实现，但是库一般不具备框架的规范性。比如bootstrap，提供了一种完整的规范和功能，我们在它的基础上进行调整。</p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/25/php连接数据库（转载二）t/" >
  php连接数据库（转载二）
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/25/php连接数据库（转载二）t/"><span class="article-date">
  2016-05-25
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/数据库/">数据库</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p><a href="http://www.cnblogs.com/csensix/archive/2012/05/23/2515494.html" target="_blank" rel="external">PHP连接MySQL数据库*转</a></p>
<p>既然现在你看到了这篇文章，说明你肯定知道PHP和MySQL是怎么一回事，我就不啰嗦了。但为什么你还要继续阅读此文呢？可能是以前你习惯复制粘贴一些代码，并没有真正弄懂代码的含义；也可能你以前弄懂了，但像我一样，有一段时间没有接触，生疏了；再或者，有人问你类似的简单问题，而你已经不屑于回答，直接上网搜索，恰好找到了这篇，于是就推荐给那谁谁谁了…不管怎样，在这里我总结了三种常用的PHP连接MySQL数据库方法，希望能够帮到你，当然也是作为我自己的一个回顾总结。</p>
<p>方法一：普通方法（面向过程）</p>
<p>首先，我先做出如下假设（也适用与方法二和方法三）</p>
<blockquote>
<p>$username=your_name;<br>$userpass=your_pass;<br>$dbhost=localhost;<br>$dbdatabase=your_database;<br>下面是关键步骤：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> 1 //生成一个连接</span><br><span class="line"> 2 $db_connect=mysql_connect($dbhost,$username,$userpass) or die(&quot;Unable to connect to the MySQL!&quot;);</span><br><span class="line"> 3 </span><br><span class="line"> 4 //选择一个需要操作的数据库</span><br><span class="line"> 5 mysql_select_db($dbdatabase,$db_connect);</span><br><span class="line"> 6 </span><br><span class="line"> 7 //执行MySQL语句</span><br><span class="line"> 8 $result=mysql_query(&quot;SELECT id,name FROM user&quot;);</span><br><span class="line"> 9 </span><br><span class="line">10 //提取数据</span><br><span class="line">11 $row=mysql_fetch_row($result);</span><br></pre></td></tr></table></figure>
<p>代码注释已经说明了一切。不过这里还需要做一些补充。</p>
<p>①在mysql_connect()、mysql_select_db()等函数之前使用@（错误控制运算符），可以忽略掉系统产生的错误信息，然后我们用die()来自定义错误信息；</p>
<p>②提取数据的时候，除了上面的mysql_fetch_row，常见的还有mysql_fetch_assoc和mysql_fetch_array，具体差别请查阅PHP Manual；</p>
<p>③对于mysql_query()函数的返回值，如果执行的语句有返回值（如SELECT、SHOW、DESCRIBE等），则返回相应数据（成功时）或FALSE（失败时）；如果执行的语句没有返回值（如DELETE、DROP、INSERT、UPDATE等），则返回TRUE（成功时）或FALSE（失败时）。</p>
<p>方法二：面向对象方法</p>
<p>其实这种方法和普通方法非常类似，只是把相应的函数换成了面向对象方法，直接看代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1 $db=new mysqli($dbhost,$username,$userpass,$dbdatabase);</span><br><span class="line">2 if(mysqli_connect_error())&#123;</span><br><span class="line">3     echo &apos;Could not connect to database.&apos;;</span><br><span class="line">4     exit;</span><br><span class="line">5 &#125;</span><br><span class="line">6 </span><br><span class="line">7 $result=$db-&gt;query(&quot;SELECT id,name FROM user&quot;);</span><br><span class="line">8 $row=$result-&gt;fetch_row();</span><br></pre></td></tr></table></figure>
<p>这里用到的是mysqli，意思就是mysql的扩展，既可以通过面向过程的方式也可以通过面向对象的方式与数据库进行交互，唯一不同的是调用函数（对象方法）的方式不一样。</p>
<p>方法三：PDO方法</p>
<p>PDO其实是PHP Database Objects的缩写，中文即PHP数据库对象。它提供了一种统一的PHP与数据库交互的方法。</p>
<p>这是目前比较流行的一种连接数据库的方法。它的优势在于：只要正确提供数据源，余下对于数据库的基本操作都是一样的。也就是说，同一段代码既可以同MySQL交互，也可以和SQLite3交互，当然也可以和PostgreSQL进行交互，前提是你提供了正确的数据源。下面看一下连接MySQL的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$dsn=&apos;mysql:host=&apos;.$dbhost.&apos;;dbname=&apos;.$dbdatabase.&apos;;&apos;</span><br><span class="line">$dbh=new PDO($dsn,$username,$userpass);</span><br><span class="line">如果是SQLite3，直接使用下面的代码：</span><br><span class="line"></span><br><span class="line">$dsn=&apos;sqlite3:&quot;C:\sqlite\user.db&quot;&apos;;</span><br><span class="line">$dbh=new PDO($dsn);</span><br><span class="line">如果是PostgreSQL，下面的代码能够对付：</span><br><span class="line"></span><br><span class="line">$dsn=&apos;pgsql:host=&apos;.$dbhost.&apos; port=5432 dbname=&apos;.$dbdatabase.&apos; user=&apos;.$username.&apos; password=&apos;.$userpass;</span><br><span class="line">$dbh=new PDO($dsn);</span><br></pre></td></tr></table></figure></p>
<p>跟数据库成功建立连接之后，下面就只需要从数据库获取数据或插入更新数据，实例代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$stmt=$dbh-&gt;query(&apos;SELECT id,name FROM user&apos;);</span><br><span class="line">$row=$stmt-&gt;fetch();</span><br></pre></td></tr></table></figure>
<p>至此，文章告一段落。当然，上面只是简单的介绍了一下PHP与数据库有关的最简单的操作，后面还有很多比如插入、排序、防止SQL注入等等一些方面的知识需要深入学习。希望有机会能够和大家一起探讨，共同进步。</p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/25/php连接数据库（转载一）/" >
  php连接数据库（转载一）
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/25/php连接数据库（转载一）/"><span class="article-date">
  2016-05-25
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/数据库/">数据库</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>忠告：写程序切记马虎，不细仔，真是写程序的大忌中的大忌。所以以后写代码务必：细心仔细不骄不燥，才能写出来好代码来，避免迷惘。。</p>
<p> 繁写：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    echo &quot;This is a test&lt;/br&gt;&quot;; </span><br><span class="line">    echo &quot;asdfasdfadsf&quot;;</span><br><span class="line">    $mysql_server_name=&quot;localhost&quot;; //数据库服务器名称</span><br><span class="line">    $mysql_username=&quot;root&quot;; // 连接数据库用户名</span><br><span class="line">    $mysql_password=&quot;??????&quot;; // 连接数据库密码</span><br><span class="line">    $mysql_database=&quot;??????&quot;; // 数据库的名字</span><br><span class="line">    </span><br><span class="line">    // 连接到数据库</span><br><span class="line">    $conn=mysql_connect($mysql_server_name, $mysql_username,</span><br><span class="line">                        $mysql_password);</span><br><span class="line">                        </span><br><span class="line">     // 从表中提取信息的sql语句</span><br><span class="line">    $strsql=&quot;SELECT * FROM `gbook`&quot;;</span><br><span class="line">    // 执行sql查询</span><br><span class="line">    $result=mysql_db_query($mysql_database, $strsql, $conn);</span><br><span class="line">    // 获取查询结果</span><br><span class="line">    $row=mysql_fetch_row($result);</span><br><span class="line">    </span><br><span class="line">     </span><br><span class="line">    echo &apos;&lt;font face=&quot;verdana&quot;&gt;&apos;;</span><br><span class="line">    echo &apos;&lt;table border=&quot;1&quot; cellpadding=&quot;1&quot; cellspacing=&quot;2&quot;&gt;&apos;;</span><br><span class="line"></span><br><span class="line">    // 显示字段名称</span><br><span class="line">    echo &quot;&lt;/b&gt;&lt;tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    for ($i=0; $i&lt;mysql_num_fields($result); $i++)</span><br><span class="line">    &#123;</span><br><span class="line">      echo &apos;&lt;td bgcolor=&quot;#000F00&quot;&gt;&lt;b&gt;&apos;.</span><br><span class="line">      mysql_field_name($result, $i);</span><br><span class="line">      echo &quot;&lt;/b&gt;&lt;/td&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &quot;&lt;/tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    // 定位到第一条记录</span><br><span class="line">    mysql_data_seek($result, 0);</span><br><span class="line">    // 循环取出记录</span><br><span class="line">    while ($row=mysql_fetch_row($result))</span><br><span class="line">    &#123;</span><br><span class="line">      echo &quot;&lt;tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">      for ($i=0; $i&lt;mysql_num_fields($result); $i++ )</span><br><span class="line">      &#123;</span><br><span class="line">        echo &apos;&lt;td bgcolor=&quot;#00FF00&quot;&gt;&apos;;</span><br><span class="line">        echo $row[$i];</span><br><span class="line">        echo &apos;&lt;/td&gt;&apos;;</span><br><span class="line">      &#125;</span><br><span class="line">      echo &quot;&lt;/tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    echo &quot;&lt;/table&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">    // 释放资源</span><br><span class="line">    mysql_free_result($result);</span><br><span class="line">    // 关闭连接</span><br><span class="line">    mysql_close($conn);  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>简写：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> $conn=mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;);             </span><br><span class="line"> $result=mysql_db_query(&quot;Database&quot;, &quot;SELECT * FROM `info`&quot;, $conn);</span><br><span class="line">    // 获取查询结果</span><br><span class="line">     $row=mysql_fetch_row($result);</span><br><span class="line">    </span><br><span class="line">     </span><br><span class="line">    echo &apos;&lt;font face=&quot;verdana&quot;&gt;&apos;;</span><br><span class="line">    echo &apos;&lt;table border=&quot;1&quot; cellpadding=&quot;1&quot; cellspacing=&quot;2&quot;&gt;&apos;;</span><br><span class="line"></span><br><span class="line">    // 显示字段名称</span><br><span class="line">    echo &quot;&lt;/b&gt;&lt;tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    for ($i=0; $i&lt;mysql_num_fields($result); $i++)</span><br><span class="line">    &#123;</span><br><span class="line">      echo &apos;&lt;td bgcolor=&quot;#000F00&quot;&gt;&lt;b&gt;&apos;.</span><br><span class="line">      mysql_field_name($result, $i);</span><br><span class="line">      echo &quot;&lt;/b&gt;&lt;/td&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    echo &quot;&lt;/tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    // 定位到第一条记录</span><br><span class="line">    mysql_data_seek($result, 0);</span><br><span class="line">    // 循环取出记录</span><br><span class="line">    while ($row=mysql_fetch_row($result))</span><br><span class="line">    &#123;</span><br><span class="line">      echo &quot;&lt;tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">      for ($i=0; $i&lt;mysql_num_fields($result); $i++ )</span><br><span class="line">      &#123;</span><br><span class="line">        echo &apos;&lt;td bgcolor=&quot;#00FF00&quot;&gt;&apos;;</span><br><span class="line">        echo $row[$i];</span><br><span class="line">        echo &apos;&lt;/td&gt;&apos;;</span><br><span class="line">      &#125;</span><br><span class="line">      echo &quot;&lt;/tr&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    echo &quot;&lt;/table&gt;&lt;/b&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">    // 释放资源</span><br><span class="line">    mysql_free_result($result);</span><br><span class="line">    // 关闭连接</span><br><span class="line">    mysql_close($conn);  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p> echo出来的主要是表格</p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/24/js跨域总结与解决办法/" >
  js跨域总结与解决办法
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/24/js跨域总结与解决办法/"><span class="article-date">
  2016-05-24
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/网络/">网络</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/跨域请求/">跨域请求</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p><a href="http://www.cnblogs.com/rainman/archive/2011/02/20/1959325.html" target="_blank" rel="external">原文链接</a><br>什么是跨域<br>JavaScript出于安全方面的考虑，不允许跨域调用其他页面的对象。但在安全限制的同时也给注入iframe或是ajax应用上带来了不少麻烦。这里把涉及到跨域的一些问题简单地整理一下：</p>
<p>首先什么是跨域，简单地理解就是因为JavaScript同源策略的限制，a.com 域名下的js无法操作b.com或是c.a.com域名下的对象。更详细的说明可以看下表：<br><img src="/img/php/QQ截图20160529204200.png" alt=""></p>
<p>特别注意两点：<br>第一，如果是协议和端口造成的跨域问题“前台”是无能为力的，<br>第二：在跨域问题上，域仅仅是通过“URL的首部”来识别而不会去尝试判断相同的ip地址对应着两个域或两个域是否在同一个ip上。<br>“URL的首部”指window.location.protocol +window.location.host，也可以理解为“Domains, protocols and ports must match”。<br>接下来简单地总结一下在“前台”一般处理跨域的办法，后台proxy这种方案牵涉到后台配置，这里就不阐述了，有兴趣的可以看看yahoo的这篇文章：<a href="http://developer.yahoo.com/javascript/howto-proxy.html" target="_blank" rel="external">《JavaScript: Use a Web Proxy for Cross-Domain XMLHttpRequest Calls》</a></p>
<p>1、document.domain+iframe的设置<br>对于主域相同而子域不同的例子，可以通过设置document.domain的办法来解决。具体的做法是可以在<a href="http://www.a.com/a.html和http://script.a.com/b.html两个文件中分别加上document.domain" target="_blank" rel="external">http://www.a.com/a.html和http://script.a.com/b.html两个文件中分别加上document.domain</a> = ‘a.com’；然后通过a.html文件中创建一个iframe，去控制iframe的contentDocument，这样两个js文件之间就可以“交互”了。当然这种办法只能解决主域相同而二级域名不同的情况，如果你异想天开的把script.a.com的domian设为alibaba.com那显然是会报错地！代码如下：</p>
<p>www.a.com上的a.html</p>
<p>document.domain = ‘a.com’;<br>var ifr = document.createElement(‘iframe’);<br>ifr.src = ‘<a href="http://script.a.com/b.html" target="_blank" rel="external">http://script.a.com/b.html</a>‘;<br>ifr.style.display = ‘none’;<br>document.body.appendChild(ifr);<br>ifr.onload = function(){<br>    var doc = ifr.contentDocument || ifr.contentWindow.document;<br>    // 在这里操纵b.html<br>    alert(doc.getElementsByTagName(“h1”)[0].childNodes[0].nodeValue);<br>};<br>script.a.com上的b.html</p>
<p>document.domain = ‘a.com’;<br>这种方式适用于{www.kuqin.com, kuqin.com, script.kuqin.com, css.kuqin.com}中的任何页面相互通信。</p>
<p>备注：某一页面的domain默认等于window.location.hostname。主域名是不带www的域名，例如a.com，主域名前面带前缀的通常都为二级域名或多级域名，例如www.a.com其实是二级域名。 domain只能设置为主域名，不可以在b.a.com中将domain设置为c.a.com。</p>
<p>问题：<br>1、安全性，当一个站点（b.a.com）被攻击后，另一个站点（c.a.com）会引起安全漏洞。<br>2、如果一个页面中引入多个iframe，要想能够操作所有iframe，必须都得设置相同domain。<br>2、动态创建script<br>虽然浏览器默认禁止了跨域访问，但并不禁止在页面中引用其他域的JS文件，并可以自由执行引入的JS文件中的function（包括操作cookie、Dom等等）。根据这一点，可以方便地通过创建script节点的方法来实现完全跨域的通信。具体的做法可以参考YUI的Get Utility</p>
<p>这里判断script节点加载完毕还是蛮有意思的：ie只能通过script的readystatechange属性，其它浏览器是script的load事件。以下是部分判断script加载完毕的方法。</p>
<p>js.onload = js.onreadystatechange = function() {<br>    if (!this.readyState || this.readyState === ‘loaded’ || this.readyState === ‘complete’) {<br>        // callback在此处执行<br>        js.onload = js.onreadystatechange = null;<br>    }<br>};<br>3、利用iframe和location.hash<br>这个办法比较绕，但是可以解决完全跨域情况下的脚步置换问题。原理是利用location.hash来进行传值。在url： <a href="http://a.com#helloword中的‘#helloworld’就是location.hash，改变hash并不会导致页面刷新，所以可以利用hash值来进行数据传递，当然数据容量是有限的。假设域名a.com下的文件cs1.html要和cnblogs.com域名下的cs2.html传递信息，cs1.html首先创建自动创建一个隐藏的iframe，iframe的src指向cnblogs.com域名下的cs2.html页面，这时的hash值可以做参数传递用。cs2.html响应请求后再将通过修改cs1.html的hash值来传递数据（由于两个页面不在同一个域下IE、Chrome不允许修改parent.location.hash的值，所以要借助于a.com域名下的一个代理iframe；Firefox可以修改）。同时在cs1.html上加一个定时器，隔一段时间来判断location.hash的值有没有变化，一点有变化则获取获取hash值。代码如下：" target="_blank" rel="external">http://a.com#helloword中的‘#helloworld’就是location.hash，改变hash并不会导致页面刷新，所以可以利用hash值来进行数据传递，当然数据容量是有限的。假设域名a.com下的文件cs1.html要和cnblogs.com域名下的cs2.html传递信息，cs1.html首先创建自动创建一个隐藏的iframe，iframe的src指向cnblogs.com域名下的cs2.html页面，这时的hash值可以做参数传递用。cs2.html响应请求后再将通过修改cs1.html的hash值来传递数据（由于两个页面不在同一个域下IE、Chrome不允许修改parent.location.hash的值，所以要借助于a.com域名下的一个代理iframe；Firefox可以修改）。同时在cs1.html上加一个定时器，隔一段时间来判断location.hash的值有没有变化，一点有变化则获取获取hash值。代码如下：</a></p>
<p>先是a.com下的文件cs1.html文件：</p>
<p>function startRequest(){<br>    var ifr = document.createElement(‘iframe’);<br>    ifr.style.display = ‘none’;<br>    ifr.src = ‘<a href="http://www.cnblogs.com/lab/cscript/cs2.html#paramdo" target="_blank" rel="external">http://www.cnblogs.com/lab/cscript/cs2.html#paramdo</a>‘;<br>    document.body.appendChild(ifr);<br>}</p>
<p>function checkHash() {<br>    try {<br>        var data = location.hash ? location.hash.substring(1) : ‘’;<br>        if (console.log) {<br>            console.log(‘Now the data is ‘+data);<br>        }<br>    } catch(e) {};<br>}<br>setInterval(checkHash, 2000);<br>cnblogs.com域名下的cs2.html:</p>
<p>//模拟一个简单的参数处理操作<br>switch(location.hash){<br>    case ‘#paramdo’:<br>        callBack();<br>        break;<br>    case ‘#paramset’:<br>        //do something……<br>        break;<br>}</p>
<p>function callBack(){<br>    try {<br>        parent.location.hash = ‘somedata’;<br>    } catch (e) {<br>        // ie、chrome的安全机制无法修改parent.location.hash，<br>        // 所以要利用一个中间的cnblogs域下的代理iframe<br>        var ifrproxy = document.createElement(‘iframe’);<br>        ifrproxy.style.display = ‘none’;<br>        ifrproxy.src = ‘<a href="http://a.com/test/cscript/cs3.html#somedata" target="_blank" rel="external">http://a.com/test/cscript/cs3.html#somedata</a>‘;    // 注意该文件在”a.com”域下<br>        document.body.appendChild(ifrproxy);<br>    }<br>}<br>a.com下的域名cs3.html</p>
<p>//因为parent.parent和自身属于同一个域，所以可以改变其location.hash的值<br>parent.parent.location.hash = self.location.hash.substring(1);<br>当然这样做也存在很多缺点，诸如数据直接暴露在了url中，数据容量和类型都有限等……</p>
<p>4、window.name实现的跨域数据传输<br>文章较长列在此处不便于阅读，详细请看 window.name实现的跨域数据传输。</p>
<p>5、使用HTML5 postMessage<br>HTML5中最酷的新功能之一就是 跨文档消息传输Cross Document Messaging。下一代浏览器都将支持这个功能：Chrome 2.0+、Internet Explorer 8.0+, Firefox 3.0+, Opera 9.6+, 和 Safari 4.0+ 。 Facebook已经使用了这个功能，用postMessage支持基于web的实时消息传递。</p>
<p>otherWindow.postMessage(message, targetOrigin);<br>otherWindow: 对接收信息页面的window的引用。可以是页面中iframe的contentWindow属性；window.open的返回值；通过name或下标从window.frames取到的值。<br>message: 所要发送的数据，string类型。<br>targetOrigin: 用于限制otherWindow，“*”表示不作限制<br>a.com/index.html中的代码：</p>
<p><iframe id="ifr" src="b.com/index.html"></iframe></p>
<p><script type="text/javascript"><br>window.onload = function() {<br>    var ifr = document.getElementById(‘ifr’);<br>    var targetOrigin = ‘<a href="http://b.com">http://b.com</a>‘;  // 若写成’<a href="http://b.com/c/proxy.html&#39;效果一样">http://b.com/c/proxy.html&#39;效果一样</a><br>                                        // 若写成’<a href="http://c.com&#39;就不会执行postMessage了">http://c.com&#39;就不会执行postMessage了</a><br>    ifr.contentWindow.postMessage(‘I was there!’, targetOrigin);<br>};<br></script><br>b.com/index.html中的代码：</p>
<p><script type="text/javascript"><br>    window.addEventListener(‘message’, function(event){<br>        // 通过origin属性判断消息来源地址<br>        if (event.origin == ‘<a href="http://a.com">http://a.com</a>‘) {<br>            alert(event.data);    // 弹出”I was there!”<br>            alert(event.source);  // 对a.com、index.html中window对象的引用<br>                                  // 但由于同源策略，这里event.source不可以访问window对象<br>        }<br>    }, false);<br></script><br>参考文章：《精通HTML5编程》第五章——跨文档消息机制、<a href="https://developer.mozilla.org/en/dom/window.postmessage" target="_blank" rel="external">https://developer.mozilla.org/en/dom/window.postmessage</a></p>
<p>6、利用flash<br>这是从YUI3的IO组件中看到的办法，具体可见<a href="http://developer.yahoo.com/yui/3/io/。" target="_blank" rel="external">http://developer.yahoo.com/yui/3/io/。</a><br>可以看在Adobe Developer Connection看到更多的跨域代理文件规范：ross-Domain Policy File Specifications、HTTP Headers Blacklist。</p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/24/js跨域请求/" >
  js跨域请求
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/24/js跨域请求/"><span class="article-date">
  2016-05-24
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/网络/">网络</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/跨域请求/">跨域请求</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p><a href="http://blog.csdn.net/chosen0ne/article/details/7333626" target="_blank" rel="external">js跨域请求,原文地址</a></p>
<ol>
<li><p>同源策略</p>
<pre><code>所有的浏览器都遵守同源策略，这个策略能够保证一个源的动态脚本不能读取或操作其他源的http响应和cookie，这就使浏览器隔离了来自不同源的内容，防止它们互相操作。所谓同源是指协议、域名和端口都一致的情况。举例来说，首先在Nginx上配置两个虚拟主机，一个监听80端口，另一个监听81端口：
</code></pre><p>[plain] view plain copy print?<br>server {  </p>
<pre><code>listen 80;  
server_name localhost;  

location / {  
    root   D:/dev/workspace;  
            index  index.html index.htm;  
}  

location ~ \.php$ {  
    # 委托给后端的php  
    }  
</code></pre><p> }  </p>
<pre><code>81端口的server配置是类似的，只是端口不同而已，所以通过80和81端口会访问到相同的东西。写两个php，一个是用于页面展示的show_person.php，另一个是用于生成json数据的person.php。
</code></pre><p>[php] view plain copy print?<br>// show_person.php  </p>
</li>
</ol>
<html><br>    <head><br>        <script type="text/javascript" src="js/jquery.min.js"></script><br>        <script type="text/javascript"><br>            function sayHello(person){<br>                alert(person.name + ‘, your age is ‘ + person.age);<br>            }<br>           // 通过jQuery的ajax请求person.php的数据<br>            $.getJSON(‘<a href="http://localhost:80/MongoTest/person.php">http://localhost:80/MongoTest/person.php</a>‘, function(data){<br>                sayHello(data);<br>            });<br>        </script><br>    </head><br>    <body><br>    </body><br></html>  

<p>[php] view plain copy print?<br>// person.php  </p>
<p>&lt;?php<br>$person = array(‘name’ =&gt; ‘kobe’, ‘age’ =&gt; 34);<br>echo json_encode($person);<br>?&gt;<br>        注意show_person.php中通过jQuery的getJSON请求<a href="http://localhost:80/MongoTest/person.php，这里是80端口。" target="_blank" rel="external">http://localhost:80/MongoTest/person.php，这里是80端口。</a><br>然后先访问80端口试试，键入url：<a href="http://localhost/cross_domain/show_person.php。会弹出对话框，显示：kobe" target="_blank" rel="external">http://localhost/cross_domain/show_person.php。会弹出对话框，显示：kobe</a>, your age is 34。<br>        然后再访问81端口，<a href="http://localhost:81/cross_domain/show_person.php，结果出错：" target="_blank" rel="external">http://localhost:81/cross_domain/show_person.php，结果出错：</a><br>XMLHttpRequest cannot load<a href="http://localhost/MongoTest/person.php" target="_blank" rel="external">http://localhost/MongoTest/person.php</a>. Origin <a href="http://localhost:81" target="_blank" rel="external">http://localhost:81</a> is not allowed by Access-Control-Allow-Origin.</p>
<pre><code>这就是同源策略作用的效果。因为浏览器中访问的是81端口的内容，而show_person.php中请求的是80端口，所以请求的是不同源的内容，浏览器直接阻止这次请求。
</code></pre><ol>
<li>打破同源策略的限制<pre><code>浏览器会阻止ajax请求非同源的内容，但没有限制&lt;script&gt;标签来访问非同源的内容，也没有限制使用动态添加&lt;script&gt;标签，所以可以采用这种方式打破这种限制。先测试下&lt;script&gt;访问非同源的内容，修改show_person.php，如下：
</code></pre>[php] view plain copy print?<br>// show_person.php  </li>
</ol>
<p><html><br>    <head><br>        <script type="text/javascript" src="js/jquery.min.js"></script><br>        <script type="text/javascript"><br>            function sayHello(person){<br>                alert(person.name + ‘, your age is ‘ + person.age);<br>            }<br>        </script>  </head></html></p>
<pre><code>    &lt;script type=&quot;text/javascript&quot; src=&quot;http://localhost:80/MongoTest/person.php&quot; &gt;&lt;/script&gt;  
&lt;/head&gt;  
&lt;body&gt;  
&lt;/body&gt;  
</code></pre><p><br>        还需要对person.php略微修改，以实现函数调用：<br>[php] view plain copy print?<br>// person.php  </p>
<p>&lt;?php<br>$person = array(‘name’ =&gt; ‘kobe’, ‘age’ =&gt; 34);<br>echo ‘sayHello(‘.json_encode($person).’)’;<br>?&gt;<br>        实际上，通过<script>标签就是将远程请求来的数据插入到<script></script>之间。访问80和81端口，都会得到希望得到的结果：kobe, your age is 34。<br>        下面就看一下，动态添加<script>标签实现跨域请求数据。修改show_person.php：<br>[php] view plain copy print?<br>// show_person.php  </p>
<p><html><br>    <head><br>        <script type="text/javascript" src="js/jquery.min.js"></script><br>        <script type="text/javascript"><br>            function sayHello(person){<br>                alert(person.name + ‘, your age is ‘ + person.age);<br>            }<br>                // 通过callback参数指定回调函数<br>            var url = ‘<a href="http://localhost:80/MongoTest/person.php?callback=sayHello">http://localhost:80/MongoTest/person.php?callback=sayHello</a>‘;<br>            var script = document.createElement(‘script’);<br>            script.setAttribute(‘src’, url);<br>            document.getElementsByTagName(‘head’)[0].appendChild(script);<br>        </script><br>    <br>    <body><br>    </body><br><br>        person.php再做修改：<br>[php] view plain copy print?<br>// person.php  </p>
<p>&lt;?php<br>$person = array(‘name’ =&gt; ‘kobe’, ‘age’ =&gt; 34);<br>echo $_REQUEST[‘callback’].’(‘.json_encode($person).’)’;<br>?&gt;<br>        通过81端口访问，发现也会打印出结果。这就实现了跨域请求，可以通过firefox的firebug或者chrome的js控制台查看html元素发现，在head元素上多了一个<script>元素<br>[html] view plain copy print?</p>
<p><script src="http://localhost:80/MongoTest/person.php?callback=sayHello"></script>  </p>
<ol>
<li>JSONP<pre><code>实际上，上面的例子就是一个JSONP的简单实现。JSONP（JSON with Padding）就是服务器端和客户端互相协作以完成跨域请求的一种协议，客户端向服务器端发送请求并附带callback函数，服务器端返回相应的js代码，这个代码就是执行回调函数，参数就是服务器端返回的JSON数据。上面例子中的person.php就是服务端的简单实现，返回的响应内容是sayHello({&quot;name&quot;:&quot;kobe&quot;,&quot;age&quot;:34})，这段内容会被客户端插入到动态生成的script标签内部。
客户端在发起跨域请求时，需要制定具体的回调函数，比如这个请求http://localhost:80/MongoTest/person.php?callback=sayHello，callback就是回调函数，服务器端也要通过callback要提取回调函数名，所以具体的这个参数需要客户端和服务器端达成一致，否则不能实现跨域。
在jQuery中拥有对JSONP的支持，只要在使用jQuery.getJSON方法时传入的url的格式是url?callback=?即可，jQuery会自动的将?替换成具体的回调函数名。上面例子的功能，可以采用jQuery改写成：
</code></pre>[javascript] view plain copy print?<br>$.getJSON(‘<a href="http://localhost:80/MongoTest/person.php?callback=?" target="_blank" rel="external">http://localhost:80/MongoTest/person.php?callback=?</a>‘, function(data){<br> sayHello(data);<br>});  <pre><code>访问81端口，可以得到正确的响应。观察一下，发现person.php的响应内容是：
        jQuery17103600438670255244_1331202380099({&quot;name&quot;:&quot;kobe&quot;,&quot;age&quot;:34})
前面的jQuery17103600438670255244_1331202380099就是jQuery动态生成的回调函数名，然后在这个回调函数内容调用后面定义的匿名函数，并将得到的JSON数据传进去。jQuery可以优化JSONP请求，如果向同一个源发出请求，jQuery 就将其转化为普通 Ajax 请求。
</code></pre></li>
</ol>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/24/浏览器拦截跨域请求处理方法/" >
  浏览器拦截跨域请求处理方法
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/24/浏览器拦截跨域请求处理方法/"><span class="article-date">
  2016-05-24
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/网络/">网络</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/跨域请求处理方法/">跨域请求处理方法</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p><a href="http://my.oschina.net/lichaoqiang/blog/317823" target="_blank" rel="external">浏览器拦截跨域请求处理方法（同源策略不允许读取XXX上的远程资源）</a></p>
<p>解决此类问题，最直接的方法就是，就是给被请求的服务器，添加HTTP头响应头，这里提供两种添加HTTP头的方法：</p>
<ul>
<li>第一种，就是在程序中添加HTTP头：</li>
</ul>
<p>如： Response.Headers.Add(“Access-Control-Allow-Origin”, “<em>“);<br>  添加此段代码的目的很简单，也就是告诉浏览器，这个资源是运行远程所有域名访问的。当然，此处的</em>也可以替换为指定的域名，出于安全考虑，建议将*替换成指定的域名。</p>
<ul>
<li><p>第二种，就是在服务器上，添加HTTP响应头。在这里，我们就以IIS6.0为例：</p>
<p> 在被请求的网站上，设置HTTP头，添加“</p>
</li>
</ul>
<p>Access-Control-Allow-Origin<br>   值为:*或指定的域名。</p>
<p>  一般完成以上工作，就可以了。网上还有说在被请求服务器根目录下创建:”crossdomain.xml”的文件。内容格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;cross-domain-policy&gt;</span><br><span class="line">  &lt;allow-access-from domain=&quot;*&quot; /&gt;</span><br><span class="line">&lt;/cross-domain-policy&gt;</span><br></pre></td></tr></table></figure></p>

        
      </div>
    </div>

  
    </div>
  

  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2016/05/24/套接字/" >
  套接字
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2016/05/24/套接字/"><span class="article-date">
  2016-05-24
</span>
</a>
        
	<span class="article-category tagcloud">
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/">技术</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/技术/网络/">网络</a></li></ul></li></ul>
	</span>


        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TCP-UDP/">TCP/UDP</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>源IP地址和目的IP地址以及源端口号和目的端口号的组合称为套接字。其用于标识客户端请求的服务器和服务。<br><a href="http://blog.csdn.net/pitt_xiong/article/details/7466632" target="_blank" rel="external">套接字</a></p>
<p>　　套接字，简单的说就是通信双方的一种约定，用套接字中的相关函数来完成通信过程。应用层通过传输层进行数据通信时，TCP和UDP会遇到同时为多个应用程序进程提供并发服务的问题。多个TCP连接或多个应用程序进程可能需要通过同一个 TCP协议端口传输数据。为了区别不同的应用程序进程和连接，许多计算机操作系统为应用程序与TCP/IP协议交互提供了称为套接字(Socket)的接口。</p>
<pre><code>区分不同应用程序进程间的网络通信和连接，主要有3个参数：通信的目的IP地址、使用的传输层协议(TCP或UDP)和使用的端口号。Socket原意是 “插座”。通过将这3个参数结合起来，与一个“插座”Socket绑定，应用层就可以和传输层通过套接字接口，区分来自不同应用程序进程或网络连接的通信，实现数据传输的并发服务。

 每一个基于TCP/IP网络通讯的程序(进程)都被赋予了唯一的端口和端口号，端口是一个信息缓冲区，用于保留Socket中的输入/输出信息，端口号是一个16位无符号整数，范围是0-65535，以区别主机上的每一个程序（端口号就像房屋中的房间号），低于256的端口号保留给标准应用程序，比如pop3的端口号就是110，每一个套接字都组合进了IP地址、端口、端口号，这样形成的整体就可以区别每一个套接字。关于WinSock中的套接字接发缓冲区的大小，可以通过WSA：getsockopt/setsockopt 来读取并设置。

Socket可以看成在两个程序进行通讯连接中的一个端点，一个程序将一段信息写入Socket中，该Socket将这段信息发送给另外一个Socket中，使这段信息能传送到其他程序中。一般一个server服务器对应很多客户端client连接，则服务器必须维护一张客户连接列表，每增加一个客户端连接服务器端都要新建一个套接字负责与新增客户端进行对话通信。

套接字主要有两类：流式套接字（SOCK_STREAM）和数据报套接字（SOCK_DGRAM）。流类型的套接字是为需要可靠连接的应用程序设计的。这些程序通常使用连续的数据流。用于这种类型套接字的协议是TCP，适合FTP这类实现。流套接字是最常用的，一些众所周知的协议如HTTP、TCP、SMTP、POP3等都是用它。

 数据报套接字使用UDP做为下层协议，是无连接的，有一个最大缓冲区大小（数据包大小的最大值）。它是为那些需要发送小数据包，并且对可靠性要求不高的应用程序设计的。与流式套接字不同，数据报套接字并不保证数据会到达终端，也不保证它是以正确的顺序到来的。数据报套接字的传输效率相当高，它经常用于音频或视频应用程序。对这些程序来说，速度比可靠性更加重要。
</code></pre><p>以下为基于Socket的C/S通信模式图：</p>
<p>(1)同步和异步问题</p>
<pre><code>同步方式指发送方发出数据后，等接收方发回响应以后才发下一个数据包的通讯方式，它是一种阻塞模式；而异步指发送方发出数据后，不等接收方发回响应，接着发送下个数据包的通讯方式，它是非阻塞模式。
</code></pre><p> 关于同步和异步，参考以下实例：</p>
<p>举例1：手机的通讯</p>
<p>手机打电话时同步，发短信是异步。</p>
<p>举例2：请你吃饭</p>
<p>同步就是你叫我去吃饭，我听到了就和你去吃饭；如果没有听到，你就不停的叫，直到我告诉你听到了，才一起去吃饭。</p>
<p>异步就是你叫我，然后自己去吃饭，我得到消息后可能立即走，也可能等到下班才去吃饭。</p>
<p>举例3：Windows消息处理</p>
<p>SendMessage同步：把一条消息投放到创建hWnd窗口的线程的消息队列中，直到消息被处理完毕才返回。</p>
<p>PostMessage异步：把一条消息投放到创建hWnd窗口的线程的消息队列中，不等消息被处理就立即返回。</p>
<p>举例4：B/S交互</p>
<p>普通B/S模式同步：提交请求-&gt;等待服务器处理（这期间客户浏览器不能干任何其他事情）-&gt;处理完毕返回。</p>
<p>AJAX技术异步: 请求通过事件触发-&gt;服务器处理（这期间浏览器仍然可以作其他事情）-&gt;处理完毕。</p>
<p>(2)基于socket的C/S结构程序设计</p>
<pre><code>套接字的本质是通信过程中所要使用的一些缓冲区及一些相关的数据结构。
</code></pre><p>1）.服务器创建监听套接字，并为它关联一个本地地址（IP和端口Port），然后进入监听状态准备接受客户的连接请求。为了接受客户的连接请求，服务器必须调用accept函数。服务器端每接收到一个客户端连接就新建一个套接字负责与该客户会话。</p>
<p>2）.客户端创建套接字后即可调用connect函数去试图连接服务器监听套接字。当服务器端的accept函数返回后，connect函数也返回。此时客户方使用socket函数创建的套接字clientSocket，服务器方使用accept返回的套接字serverSocket，双方就可以通信了。</p>
<p>(3)关于服务器端监听套接字和accept返回的新的套接字的区别</p>
<pre><code>一个连接由server_ip, server_port, client_ip, server_port唯一确定。你可用getsockname和getpeername由某个socket取得。

关于监听套接字和accept返回的新的套接字的区别，借用以下情景说明。好比你去吃饭，饭馆门迎小姐（监听SOCKET）看到你来后和你打招呼，然后（ACCEPT）找来一个服务员小姐（NEW SOCKET）伺候你，然后守在门口继续欢迎（监听）下一个。当然门迎小姐会记录是哪一位服务员小姐招待了你；如再有新客人来，门迎小姐（同一监听SOCKET）又会安排另一位服务员小姐（NEW SOCKET）伺候。门迎小姐走了，伺候每一位客人的服务员小姐不受影响。从以上情景可知连接建立后，客户端用发出连接的那个SOCKET向服务器发数据，是发给服务器新创建的SOCKET，而不是服务器的监听SOCKET。服务器的监听SOCKET永远只是用来接受连接请求。
</code></pre>
        
      </div>
    </div>

  
    </div>
  



  <div class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/5/">下一页</a>
  </div>




          <div class="main-footer">
  
    © 2016 findmoon-白色蜗牛 - Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>

      
        </div>
      
    </div>
  </div>
  <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>

  <link rel="stylesheet" href="/PhotoSwipe/photoswipe.css">
  <link rel="stylesheet" href="/PhotoSwipe/default-skin/default-skin.css">

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/PhotoSwipe/photoswipe.js"></script>
  <script src="/PhotoSwipe/photoswipe-ui-default.js"></script>


<script src="/perfect-scrollbar/js/min/perfect-scrollbar.min.js"></script>
<script src="/scripts/main.js"></script>

</body>
</html>
